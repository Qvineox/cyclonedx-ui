syntax = "proto3";

package cyclonedx_ui.sbom.v1;

option go_package = "github.com/Qvineox/cyclonedx-ui/gen/go/api/proto/sbom/v1;sbom_v1";

import "google/protobuf/timestamp.proto";

message Vulnerability {
  string id = 1;

  optional Source source = 2;
  string description = 3;
  string detail = 4;
  string recommendation = 5;

  optional float max_rating = 6;
  repeated Rating ratings = 7;
  repeated int32 cwes = 8;
  repeated Advisory advisories = 9;

  repeated Affect affects = 10;

  optional google.protobuf.Timestamp created_at = 11;
  optional google.protobuf.Timestamp published_at = 12;
  optional google.protobuf.Timestamp updated_at = 13;
  optional google.protobuf.Timestamp rejected_at = 14;
}

message Rating {
  optional Source source = 1;

  optional float score = 2;
  string severity = 3;

  string method = 4;
  string vector = 5;
  string justification = 6;
}

message Source {
  string source = 1;
  string url = 2;
}

message Advisory {
  string title = 1;
  string url = 2;
}

message Affect {
  string ref = 1;

  repeated Range ranges = 2;
}

message Range {
  string version = 1;
  string range = 2;
  string status = 3;
}